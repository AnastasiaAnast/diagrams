# Конечный автомат

- Что такое конечный автомат
- Вариации конечных автоматов

**PlantUML** - свободный, открытый язык, инструмент для создания UML-диаграмм, который позволяет создавать графические представления различных типов моделей, включая диаграммы классов, диаграммы последовательностей, диаграммы состояний и проч.

## Конечный автомат, диаграмма состояний

**Конечный автомат** - математическая модель, описывающая поведение автомата с помощью состояний, событий, переходов между состояниями. Можно использовать для реализации автоматического контроля в программе.

Примеры: Автомат, проверяющий, является ли входная строка четным числом.

- В этой таблице переходов, если автомат находится в стартовом состоянии и получает входной символ "0", он переходит в состояние "Состояние 1".
- Если автомат находится в состоянии "Состояние 1" и получает входной символ "1", он переходит в состояние "Состояние 2".
- И так далее.

| Текущее состояние | Введенный символ | Следующее состояние |
| ----------------- | ---------------- | ------------------- |
| Старт             | 0                | Состояние 1         |
| Состояние 1       | 1                | Состояние 2         |
| Состояние 2       | 0                | Состояние 1         |

**Диаграмма состояний** - один из инструментов описания таблицы переходов - графическое представление конечного автомата, показывающее состояния в виде вершин, переходы между состояниями в виде ребер. Можно использовать для визуального представления всех процессов, переходов в системе: как, на какие данные, каким образом будет реагировать система (а конечный автомат описывает это математически).

## Элементы конечного автомата:

1. **Таблицы переходов** - таблица, используемая в конечных автоматах, для описания переходов между состояниями автомата в зависимости от входных символов. Строка соответствует одному состоянию автомата, столбец - одному символу входной последовательности. Ячейки содержат номер следующего состояния автомата.
2. **Текущее состояние автомата** - состояние, в котором находится автомат в данный момент.
3. **Стартовое состояние** - начальное состояние, в котором находится конечный автомат в начале работы.
4. **Заключительное состояние** - состояние, в котором конечный автомат завершает работу после прохождения всех состояний и входных символов

## Таблица переходов состояний

Пример 1: Чайник: Стартовое состояние: «в режиме ожидания». Событие: пользователь нажимает кнопку «включения/выключения». Событие: вода нагрелась до заданной температуры.

| Текущее состояние       | Символ                       | Следующее состояние     |
| ----------------------- | ---------------------------- | ----------------------- |
| В режиме ожидания       | Нажата кнопка «вкл/выкл»     | В процессе нагрева воды |
| В процессе нагрева воды | Вода нагрелась до заданной t | В режиме ожидания       |

Пример 2: Система контроля доступа в здание. Стартовым состоянием в этом случае будет «Доступ запрещен», а заключительным «Доступ разрешен».

| Текущее состояние          | Символ                  | Следующее состояние        |
| -------------------------- | ----------------------- | -------------------------- |
| Доступ запрещен            | Ключ                    | Ожидание ввода пин-кода    |
| Ожидание ввода пин-кода    | Ввод символов           | Ожидание проверки пин-кода |
| Ожидание проверки пин-кода | Проверка пин-кода       | Доступ разрешен            |
| Ожидание проверки пин-кода | Отрицательный результат | Доступ запрещен            |
| Доступ разрешен            | Ключ                    | Доступ запрещен            |

Пример 3: Проверка синтаксиса арифметического выражения.
Состояниями автомата будут являться:

- «start» — начальное состояние;
- «number» — если в выражении встречена цифра;
- «operator» — если в выражении встречен оператор;
- «error» — в случае ошибки синтаксиса.

| Текущее состояние | Символ   | Следующее состояние |
| ----------------- | -------- | ------------------- |
| start             | цифра    | number              |
| start             | оператор | operator            |
| number            | цифра    | number              |
| number            | оператор | operator            |
| operator          | цифра    | number              |
| operator          | оператор | error               |

## Применение конечных автоматов

Пример 1: Программа проверки домашнего задания студентов Гикбрейнса.
Может иметь состояния:

- «Не начато» — студент еще не начал выполнять домашнее задание.
- «В процессе» — студент в процессе выполнения домашнего задания.
- «Отправлено» — студент отправил свое домашнее задание на проверку.
- «Оценено» — домашнее задание проверено и получило оценку.

| Текущее состояние | Входные данные | Следующее состояние |
| ----------------- | -------------- | ------------------- |
| Не начато         | Начало работы  | В процессе          |
| В процессе        | Отправка       | Отправлено          |
| Отправлено        | Оценка         | Оценено             |

Пример 2: Конечный автомат воронки продаж: визуализировать, математизировать сист-му по работе с воронкой продаж.

| Текущее состояние                  | Входные данные        | Следующее состояние                |
| ---------------------------------- | --------------------- | ---------------------------------- |
| Потенциальный клиент               | Оставление информации | Заинтересованный клиент            |
| Заинтересованный клиент            | Рассмотр предложения  | Потенциальный покупатель           |
| Потенциальный покупатель           | Запрос доп инф        | Заинтересованный, с инф о продукте |
| Заинтересованный, с инф о продукте | Получение предложения | Окончательный покупатель           |
| Окончательный покупатель           | Подтверждение покупки | -                                  |

Продакт, проджект менеджеры:

- Управление жизненным циклом продукта: конечные автоматы могут использоваться для отображения различных состояний продукта, переходов между ними, в релизах, версиях, исправлениях.
- Управление проектом: конечные автоматы могут использоваться для отображения, отслеживания этапов проекта, планирования, разработки, тестирования, выпуска.
- Оценка рисков: конечные автоматы могут использоваться для моделирования рисков, выявления возможных сценариев для их минимизации.
- Отслеживание сроков исполнения: конечные автоматы могут использоваться для отслеживания сроков выполнения проекта, чтобы определять, в какой стадии проекта находится, для предотвращения задержек.
- Автоматизация рутинных задач: Конечные автоматы могут использоваться для автоматизации рутинных задач, таких как отслеживание задач или выполнение действий в ответ на события.

Аналитики:

- Обработка текстовых данных: анализ текстов, определение тональности, классификация текстов или элементов в них.
- Обнаружение мошенничества: анализ транзакций, определение аномалий в поведении пользователей.
- Маркетинг: анализ данных о поведении покупателей, идентификация паттернов поведения и сегментация аудитории.
- Биоинформатика: анализ генетических данных, поиск зависимостей между генами и заболеваниями.
- Управление производством: мониторинг и контроль производственных процессов, определение аномалий.
- Телекоммуникации: мониторинг сетевых устройств, определение аномалий или ошибок.

Разработчики:

- Реализация состояний: программисты могут использовать конечные автоматы для реализации систем, основанных на состояниях, таких как игры, медиаплееры или устройства умного дома.
- Улучшение кода: использование конечных автоматов помогает программистам улучшить читаемость и управляемость кода, устраняя ненужную сложность и дублирование кода.
- Реализация протоколов: программисты могут использовать конечные автоматы для реализации протоколов связи, таких как протокол передачи данных по сети.
- Автоматизация процессов: программисты могут использовать конечные автоматы для автоматизации рутинных задач, таких как обработка данных.

Тестировщики:

- Проектирование тестовых случаев для проверки правильной работы состояний в программных приложениях.
- Моделирование ожидаемого поведения программных систем и использование этой информации для написания более эффективных тестов.
- Тестирование производительности и масштабируемости программных систем, использующих состояния.
- Отладка проблем, связанных с переходами состояний в программных системах.

## Типы конечных автоматов

1. **Детерминированные конечные автоматы** и **недетерминированные конечные автоматы**.
   **Детерминированный конечный автомат** - имеет единственный переход из каждого состояния при данном входном символе.
   **НЕдетерминированный конечный автомат** - модель конечного автомата, в которой возможен переход из одного состояния в несколько других одновременно при получении одного и того же символа входной строки.

Пример: Автомат, который определяет, является ли входная строка целым числом.

- Состояниями автомата могут быть «начало», «цифра», «ошибка».
- Если символ является цифрой, то автомат переходит в состояние «цифра».
- Если символ не является цифрой, то автомат переходит в состояние «ошибка», завершаем выполнение нашего автомата.
- Если входная строка заканчивается в состоянии «цифра», то выражение является целым числом, в противном случае — нет.

Пример: Автомат, проверяющий, является ли входная строка палиндромом (начальный символ совпадает с конечным, второй - с предпоследним и тд.).

- В качестве состояний могут быть «начало строки», «середина строки», «конец строки».
- На каждом шаге автомат сравнивает символ с начала и конца строки.
- Если символы совпадают, то автомат переходит в следующее состояние, если нет, то автомат заканчивает работу и выдает «нет».
- Можно представить таблицу для начала из середины строки, которая показывает, какие переходы возможны на каждом шаге

2.  **Конечные автоматы с памятью**
    Расширенный вариант конечного автомата, который имеет дополнительный стек (структура данных, организованная по принципу lifo - last in first out - последний пришел - первый ушел, последний добавленный эл-т уходит первым) для хранения информации. Это позволяет выполнять более сложные операции парсинга, такие как разбор выражений, вложенных скобок.

Пример: конечный автомат для проверки суммы чека в магазине.

- Стартовое состояние: Проверка пуста.
- Текущее состояние: Добавление товара в чек.
- Заключительное состояние: Проверка завершена, выдача результата (соответствует сумма или нет).

3.  **Машина Тьюринга**
    Абстрактный компьютер, выполняющий вычисления, используя 2 понятия: _последовательность команд_ и _память с перезаписываемым содержимым_ (обычно - в виде стека).

Пример 1:

1.  Прочитать 1-е число.
2.  Поместить его в стек.
3.  Прочитать 2-е число.
4.  Поместить его в стек.
5.  Извлечь верхний элемент из стека, сложить его со следующим верхним элементом.
6.  Результат сложения поместить в стек.
7.  Выдать результат из стека.

Пример 2:
Конечный автомат для описания статуса обучения:

| Текущее состояние | Событие            | Следующее состояние |
| ----------------- | ------------------ | ------------------- |
| Не зачислен       | Зачислить          | Зачислен            |
| Зачислен          | Сессия             | Сессия              |
| Сессия            | Пересдача          | Зачислен            |
| Сессия            | Академ отпуск      | Академ отпуск       |
| Зачислен          | Отчислить          | Отчислен            |
| Отчислен          | Поступить повторно | Не зачислен         |
| Академ отпуск     | Вернуться          | Зачислен            |

## Моделирование жизненного цикла объекта

## Жизненный цикл объекта

1. **Состояния**
   1-й шаг в моделировании жизненного цикла объекта — определить его состояния.
   Например, для объекта «автомобиль» состояния могут быть «в движении», «стоит на месте», «в ремонте» и т.д. Состояния могут быть взаимоисключающими, объект может находиться в нескольких состояниях одновременно.

2. **События**
   Действия, которые могут произойти с объектом. Могут приводить к изменению состояния объекта.
   Например, для объекта «автомобиль» события могут быть «завести двигатель», «остановиться на светофоре», «выйти из строя двигатель» и т.д.

3. **Переходы**
   Связывают состояния объекта и события. Могут быть условными - переход происходит при определенных условиях.
   Например, для объекта «автомобиль» переход может быть «из состояния 'в движении' в состояние 'стоит на месте' при событии 'остановиться на светофоре'».

4. **Действия**
   Выполняются при переходе из одного состояния в другое. Могут быть как внутренними для объекта, так и вызывать внешние события/функции.
   Например, для объекта «автомобиль» действие может быть «включить сигнал поворота при переходе из состояния 'в движении' в состояние 'поворот налево'».

5. **Конечное состояние**
   Когда объект перестает существовать, он достигает конечного состояния, в котором может быть удален из памяти/переведен в режим ожидания.
   Например, для объекта «автомобиль» конечное состояние может быть «утилизация».

### Модель CRUD: 4 ф-ии:

Создание (Create) ->
Чтение (Read) ->
Обновление (Update) ->
Удаление (Delete)

Концепция CRUD используется в диаграммах состояния для описания всевозможных переходов между этими состояниями объектов.

## Усложнение конечных автоматов
